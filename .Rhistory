Rest$Male <- DD[,list(Male=sum(Male)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]$Male
sum(Rest$Male) - sum(DD$Male)
Deaths.data <- rbind(CEPAL2004,Rest)
library(data.table)
library(reshape2)
library(latticeExtra)
setwd('C:/Users/jmaburto/Documents/GitHub/CoD-burden-on-LA')
source('R/1_Get_All_Data.R')
cause.name.vec <- c('Total', 'Infectious','Neoplasms', 'Circulatory','Abnormal', 'Mental',
'Nervous','Endocrine','Digestive',
'Genitourinary','Perinatal','Respiratory','External','Homicide','Rest')
Deaths.data$Cause.name <- Deaths.data$Cause
Deaths.data$Cause.name <- factor(Deaths.data$Cause.name, levels = 1:15, labels = cause.name.vec)
Deaths.data            <- Deaths.data[Deaths.data$Cause > 1,]
Deaths.data            <- Deaths.data[Deaths.data$Age2 < 96]
unique(Deaths.data$Age2)
unique(Deaths.data$Cause.name)
DD <- Deaths.data
unique(DD$Age)
DD[DD$Age2>=80]$Age2 <- 80
DD[DD$Age=="80 - 84" | DD$Age=="85 - 89"|DD$Age=='80-84'|DD$Age=="90 - 94" | DD$Age=="95+"]$Age <- "80+"
CEPAL2004 <- DD[,list(Female=sum(Female)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]
sum(CEPAL2004$Female) - sum(DD$Female)
CEPAL2004$Male <- DD[,list(Male=sum(Male)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]$Male
sum(CEPAL2004$Male) - sum(DD$Male)
## Now for the rest, lets close CoD data at 85
DD <- Deaths.data
unique(DD$Age)
DD[DD$Age2>=85]$Age2 <- 85
DD[DD$Age=="85 - 89"|DD$Age=='80-84'|DD$Age=="90 - 94" | DD$Age=="95+"]$Age <- "85+"
Rest <- DD[,list(Female=sum(Female)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]
sum(Rest$Female) - sum(DD$Female)
Rest$Male <- DD[,list(Male=sum(Male)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]$Male
sum(Rest$Male) - sum(DD$Male)
CEPAL2004$Source <- 'CEPAL2004'
Rest$Source      <- 'Rest'
Deaths.data <- rbind(CEPAL2004,Rest)
table(Deaths.data$Country,Deaths.data$Year)
save(Deaths.data,file = 'Outcomes/Harmonized_CoDData.RData')
gdata::keep(Deaths.data,cause.name.vec,Country.code.vec,Count,sure = T)
gdata::keep(Deaths.data,cause.name.vec,Country.code.vec,Country.name.vec,sure = T)
setwd('C:/Users/jmaburto/Documents/GitHub/CoD-burden-on-LA')
library(reshape2)
library(data.table)
# Load outcomes from data harmonization and proportions by age of causes of death
# 1 is males
source('R/5_Proportions_Age.R')
unique(Deaths.data$Age)
unique(Deaths.data$Year)
load('Outcomes/Data_Lifetables.RData')
unique(Data.LT$Year)
Country.code.vec
names(Country.code.vec) <- Country.name.vec
Country.code.vec
CEPAL2004D <-   Deaths.data[Deaths.data$X == 2170|
Deaths.data$X == 2140|
Deaths.data$X == 2190|
Deaths.data$X == 2250|
Deaths.data$X == 2310|
Deaths.data$X == 2340|
Deaths.data$X == 2020|
Deaths.data$X == 2120|
Deaths.data$X == 2130|
Deaths.data$X == 2180|
Deaths.data$X == 2360|
Deaths.data$X == 2370|
Deaths.data$X == 2460|
Deaths.data$X == 2470|
Deaths.data$X == 2070|
Deaths.data$X == 2150,]
CEPAL2004LT <-            Data.LT[Data.LT$Code == 2170|
Data.LT$Code == 2140|
Data.LT$Code == 2190|
Data.LT$Code == 2250|
Data.LT$Code == 2310|
Data.LT$Code == 2340|
Data.LT$Code == 2020|
Data.LT$Code == 2120|
Data.LT$Code == 2130|
Data.LT$Code == 2180|
Data.LT$Code == 2360|
Data.LT$Code == 2370|
Data.LT$Code == 2460|
Data.LT$Code == 2470|
Data.LT$Code == 2070|
Data.LT$Code == 2150,]
unique(CEPAL2004D$Country)
unique(CEPAL2004LT$Country)
Periods <- seq(1990,2015,5)
Periods
i <- Periods[1]
i
Period.labels <- CEPAL2004LT$Period
Period.labels
Period.labels <- unique(CEPAL2004LT$Period)
Period.labels
CEPAL2004LT <-            Data.LT[(Data.LT$Code == 2170|Data.LT$Code == 2140|Data.LT$Code == 2190|
Data.LT$Code == 2250|Data.LT$Code == 2310|Data.LT$Code == 2340|
Data.LT$Code == 2020|Data.LT$Code == 2120|Data.LT$Code == 2130|
Data.LT$Code == 2180|Data.LT$Code == 2360|Data.LT$Code == 2370|
Data.LT$Code == 2460|Data.LT$Code == 2470|Data.LT$Code == 2070|
Data.LT$Code == 2150) & Data.LT$Source == 'CEPAL2004',]
unique(CEPAL2004D$Country)
unique(CEPAL2004LT$Country)
Periods      <- seq(1990,2015,5)
Period.labels <- unique(CEPAL2004LT$Period)
Period.labels
Periods
Periods      <- seq(1990,2010,5)
unique(CEPAL2004LT$Year)
unique(CEPAL2004D$Year)
Periods      <- seq(1990,2010,5)
Period.labels <- unique(CEPAL2004LT$Period)
Periods
CEPAL2004D$Age5       <- (cut(CEPAL2004D$Age2+1, breaks=c(Periods,Inf),labels=Period.labels))
View(CEPAL2004D)
CEPAL2004D$Period5       <- (cut(CEPAL2004D$Year+1, breaks=c(Periods,Inf),labels=Period.labels))
View(CEPAL2004D)
CEPAL2004D <-   Deaths.data[Deaths.data$X == 2170|Deaths.data$X == 2140|Deaths.data$X == 2190|
Deaths.data$X == 2250|Deaths.data$X == 2310|Deaths.data$X == 2340|
Deaths.data$X == 2020|Deaths.data$X == 2120|Deaths.data$X == 2130|
Deaths.data$X == 2180|Deaths.data$X == 2360|Deaths.data$X == 2370|
Deaths.data$X == 2460|Deaths.data$X == 2470|Deaths.data$X == 2070|
Deaths.data$X == 2150,]
CEPAL2004LT <-            Data.LT[(Data.LT$Code == 2170|Data.LT$Code == 2140|Data.LT$Code == 2190|
Data.LT$Code == 2250|Data.LT$Code == 2310|Data.LT$Code == 2340|
Data.LT$Code == 2020|Data.LT$Code == 2120|Data.LT$Code == 2130|
Data.LT$Code == 2180|Data.LT$Code == 2360|Data.LT$Code == 2370|
Data.LT$Code == 2460|Data.LT$Code == 2470|Data.LT$Code == 2070|
Data.LT$Code == 2150) & Data.LT$Source == 'CEPAL2004',]
unique(CEPAL2004D$Country)
unique(CEPAL2004LT$Country)
unique(CEPAL2004LT$Year)
unique(CEPAL2004D$Year)
Periods      <- seq(1990,2010,5)
Period.labels <- unique(CEPAL2004LT$Period)
CEPAL2004D$Period5       <- (cut(CEPAL2004D$Year+1, breaks=c(Periods,Inf),labels=Period.labels))
View(CEPAL2004D)
CEPAL2004D2 <- CEPAL2004D[,list(Female=sum(Female)), by = list(X,Cause,Age,Country,Age2,Cause.name,Source,Period5)]
CEPAL2004D2$Male <- CEPAL2004D[,list(Male=sum(Male)), by = list(X,Cause,Age,Country,Age2,Cause.name,Source,Period5)]$Male
unique(CEPAL2004D2$Period5)
48169/2
48160/2880
table(CEPAL2004D2$Period5,CEPAL2004D2$Country)
table(CEPAL2004LT$Period,CEPAL2004LT$Country)
602/36
View(CEPAL2004D2)
602/14
table(CEPAL2004D2$X,CEPAL2004D2$Country)
table(CEPAL2004D2$X,CEPAL2004D2$Cause)
table(CEPAL2004D2$Age,CEPAL2004D2$cause)
table(CEPAL2004D2$Age2,CEPAL2004D2$cause)
table(CEPAL2004D2$Country,CEPAL2004D2$cause)
table(CEPAL2004D2$X,CEPAL2004D2$Country)
table(CEPAL2004D2$X,CEPAL2004D2$Age)
unique(CEPAL2004D2$Age)
library(data.table)
library(reshape2)
library(latticeExtra)
setwd('C:/Users/jmaburto/Documents/GitHub/CoD-burden-on-LA')
source('R/1_Get_All_Data.R')
cause.name.vec <- c('Total', 'Infectious','Neoplasms', 'Circulatory','Abnormal', 'Mental',
'Nervous','Endocrine','Digestive',
'Genitourinary','Perinatal','Respiratory','External','Homicide','Rest')
Deaths.data$Cause.name <- Deaths.data$Cause
Deaths.data$Cause.name <- factor(Deaths.data$Cause.name, levels = 1:15, labels = cause.name.vec)
Deaths.data            <- Deaths.data[Deaths.data$Cause > 1,]
Deaths.data            <- Deaths.data[Deaths.data$Age2 < 96]
unique(Deaths.data$Age2)
unique(Deaths.data$Cause.name)
DD <- Deaths.data
unique(DD$Age)
DD[DD$Age2>=80]$Age2 <- 80
DD[DD$Age=="80 - 84" | DD$Age=="85 - 89"|DD$Age=='80-84'|DD$Age=="90 - 94" | DD$Age=="95+"]$Age <- "80+"
unique(DD$Age)
CEPAL2004 <- DD[,list(Female=sum(Female)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]
sum(CEPAL2004$Female) - sum(DD$Female)
CEPAL2004$Male <- DD[,list(Male=sum(Male)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]$Male
sum(CEPAL2004$Male) - sum(DD$Male)
unique(CEPAL2004$Age)
DD <- Deaths.data
unique(DD$Age)
DD[DD$Age2>=85]$Age2 <- 85
DD[DD$Age=="85 - 89"|DD$Age=='80-84'|DD$Age=="90 - 94" | DD$Age=="95+"]$Age <- "85+"
Rest <- DD[,list(Female=sum(Female)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]
sum(Rest$Female) - sum(DD$Female)
Rest$Male <- DD[,list(Male=sum(Male)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]$Male
sum(Rest$Male) - sum(DD$Male)
unique(Rest$Age)
CEPAL2004$Source <- 'CEPAL2004'
Rest$Source      <- 'Rest'
unique(CEPAL2004$Age)
table(Deaths.data$Country,Deaths.data$Year)
save(Deaths.data,file = 'Outcomes/Harmonized_CoDData.RData')
gdata::keep(Deaths.data,cause.name.vec,Country.code.vec,Country.name.vec,sure = T)
setwd('C:/Users/jmaburto/Documents/GitHub/CoD-burden-on-LA')
library(reshape2)
library(data.table)
# Load outcomes from data harmonization and proportions by age of causes of death
# 1 is males
source('R/5_Proportions_Age.R')
load('Outcomes/Data_Lifetables.RData')
load('Outcomes/Data_Lifetables.RData')
library(data.table)
library(reshape2)
library(latticeExtra)
setwd('C:/Users/jmaburto/Documents/GitHub/CoD-burden-on-LA')
source('R/1_Get_All_Data.R')
cause.name.vec <- c('Total', 'Infectious','Neoplasms', 'Circulatory','Abnormal', 'Mental',
'Nervous','Endocrine','Digestive',
'Genitourinary','Perinatal','Respiratory','External','Homicide','Rest')
Deaths.data$Cause.name <- Deaths.data$Cause
Deaths.data$Cause.name <- factor(Deaths.data$Cause.name, levels = 1:15, labels = cause.name.vec)
Deaths.data            <- Deaths.data[Deaths.data$Cause > 1,]
Deaths.data            <- Deaths.data[Deaths.data$Age2 < 96]
unique(Deaths.data$Age2)
unique(Deaths.data$Cause.name)
### First create same age groups as in the lifetable information, all sources used (UN, CEPAL and Lambda)
### CEPAL 2004 is 80+
### CEPAL 2010 is 100+
### UN is 85+
### Lambda is 85+
##because there might some years that CoD data closes at 85+ and oders 95+,
##I am closing everything at 85+, after 85+ everything will be accumulated in cause of death 15
##for CEPAL2004, everything will close at 80+
DD <- Deaths.data
unique(DD$Age)
DD[DD$Age2>=80]$Age2 <- 80
DD[DD$Age=="80 - 84" | DD$Age=="85 - 89"|DD$Age=='80-84'|DD$Age=="90 - 94" | DD$Age=="95+"]$Age <- "80+"
CEPAL2004 <- DD[,list(Female=sum(Female)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]
sum(CEPAL2004$Female) - sum(DD$Female)
CEPAL2004$Male <- DD[,list(Male=sum(Male)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]$Male
sum(CEPAL2004$Male) - sum(DD$Male)
unique(CEPAL2004$Age)
## Now for the rest, lets close CoD data at 85
DD <- Deaths.data
unique(DD$Age)
DD[DD$Age2>=85]$Age2 <- 85
DD[DD$Age=="85 - 89"|DD$Age=='80-84'|DD$Age=="90 - 94" | DD$Age=="95+"]$Age <- "85+"
Rest <- DD[,list(Female=sum(Female)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]
sum(Rest$Female) - sum(DD$Female)
Rest$Male <- DD[,list(Male=sum(Male)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]$Male
sum(Rest$Male) - sum(DD$Male)
unique(Rest$Age)
### New CoD dataset
CEPAL2004$Source <- 'CEPAL2004'
Rest$Source      <- 'Rest'
Deaths.data <- rbind(CEPAL2004,Rest)
table(Deaths.data$Country,Deaths.data$Year)
save(Deaths.data,file = 'Outcomes/Harmonized_CoDData.RData')
gdata::keep(Deaths.data,cause.name.vec,Country.code.vec,Country.name.vec,sure = T)
names(Country.code.vec) <- Country.name.vec
CEPAL2004D <-   Deaths.data[Deaths.data$X == 2170|Deaths.data$X == 2140|Deaths.data$X == 2190|
Deaths.data$X == 2250|Deaths.data$X == 2310|Deaths.data$X == 2340|
Deaths.data$X == 2020|Deaths.data$X == 2120|Deaths.data$X == 2130|
Deaths.data$X == 2180|Deaths.data$X == 2360|Deaths.data$X == 2370|
Deaths.data$X == 2460|Deaths.data$X == 2470|Deaths.data$X == 2070|
Deaths.data$X == 2150,]
CEPAL2004LT <-            Data.LT[(Data.LT$Code == 2170|Data.LT$Code == 2140|Data.LT$Code == 2190|
Data.LT$Code == 2250|Data.LT$Code == 2310|Data.LT$Code == 2340|
Data.LT$Code == 2020|Data.LT$Code == 2120|Data.LT$Code == 2130|
Data.LT$Code == 2180|Data.LT$Code == 2360|Data.LT$Code == 2370|
Data.LT$Code == 2460|Data.LT$Code == 2470|Data.LT$Code == 2070|
Data.LT$Code == 2150) & Data.LT$Source == 'CEPAL2004',]
unique(CEPAL2004D$Country)
unique(CEPAL2004LT$Country)
unique(CEPAL2004LT$Year)
unique(CEPAL2004D$Year)
load('Outcomes/Data_Lifetables.RData')
source('R/5_Proportions_Age.R')
library(data.table)
library(reshape2)
library(latticeExtra)
setwd('C:/Users/jmaburto/Documents/GitHub/CoD-burden-on-LA')
source('R/1_Get_All_Data.R')
cause.name.vec <- c('Total', 'Infectious','Neoplasms', 'Circulatory','Abnormal', 'Mental',
'Nervous','Endocrine','Digestive',
'Genitourinary','Perinatal','Respiratory','External','Homicide','Rest')
Deaths.data$Cause.name <- Deaths.data$Cause
Deaths.data$Cause.name <- factor(Deaths.data$Cause.name, levels = 1:15, labels = cause.name.vec)
Deaths.data            <- Deaths.data[Deaths.data$Cause > 1,]
Deaths.data            <- Deaths.data[Deaths.data$Age2 < 96]
unique(Deaths.data$Age2)
unique(Deaths.data$Cause.name)
### First create same age groups as in the lifetable information, all sources used (UN, CEPAL and Lambda)
### CEPAL 2004 is 80+
### CEPAL 2010 is 100+
### UN is 85+
### Lambda is 85+
##because there might some years that CoD data closes at 85+ and oders 95+,
##I am closing everything at 85+, after 85+ everything will be accumulated in cause of death 15
##for CEPAL2004, everything will close at 80+
DD <- Deaths.data
unique(DD$Age)
DD[DD$Age2>=80]$Age2 <- 80
DD[DD$Age=="80 - 84" | DD$Age=="85 - 89"|DD$Age=='80-84'|DD$Age=="90 - 94" | DD$Age=="95+"]$Age <- "80+"
CEPAL2004 <- DD[,list(Female=sum(Female)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]
sum(CEPAL2004$Female) - sum(DD$Female)
CEPAL2004$Male <- DD[,list(Male=sum(Male)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]$Male
sum(CEPAL2004$Male) - sum(DD$Male)
unique(CEPAL2004$Age)
## Now for the rest, lets close CoD data at 85
DD <- Deaths.data
unique(DD$Age)
DD[DD$Age2>=85]$Age2 <- 85
DD[DD$Age=="85 - 89"|DD$Age=='80-84'|DD$Age=="90 - 94" | DD$Age=="95+"]$Age <- "85+"
Rest <- DD[,list(Female=sum(Female)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]
sum(Rest$Female) - sum(DD$Female)
Rest$Male <- DD[,list(Male=sum(Male)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]$Male
sum(Rest$Male) - sum(DD$Male)
unique(Rest$Age)
### New CoD dataset
CEPAL2004$Source <- 'CEPAL2004'
Rest$Source      <- 'Rest'
Deaths.data <- rbind(CEPAL2004,Rest)
table(Deaths.data$Country,Deaths.data$Year)
save(Deaths.data,file = 'Outcomes/Harmonized_CoDData.RData')
gdata::keep(Deaths.data,cause.name.vec,Country.code.vec,Country.name.vec,sure = T)
load('Outcomes/Data_Lifetables.RData')
unique(Deaths.data$Age)
unique(Deaths.data$Year)
unique(Data.LT$Year)
names(Country.code.vec) <- Country.name.vec
CEPAL2004D <-   Deaths.data[Deaths.data$X == 2170|Deaths.data$X == 2140|Deaths.data$X == 2190|
Deaths.data$X == 2250|Deaths.data$X == 2310|Deaths.data$X == 2340|
Deaths.data$X == 2020|Deaths.data$X == 2120|Deaths.data$X == 2130|
Deaths.data$X == 2180|Deaths.data$X == 2360|Deaths.data$X == 2370|
Deaths.data$X == 2460|Deaths.data$X == 2470|Deaths.data$X == 2070|
Deaths.data$X == 2150,]
CEPAL2004LT <-            Data.LT[(Data.LT$Code == 2170|Data.LT$Code == 2140|Data.LT$Code == 2190|
Data.LT$Code == 2250|Data.LT$Code == 2310|Data.LT$Code == 2340|
Data.LT$Code == 2020|Data.LT$Code == 2120|Data.LT$Code == 2130|
Data.LT$Code == 2180|Data.LT$Code == 2360|Data.LT$Code == 2370|
Data.LT$Code == 2460|Data.LT$Code == 2470|Data.LT$Code == 2070|
Data.LT$Code == 2150) & Data.LT$Source == 'CEPAL2004',]
unique(CEPAL2004D$Country)
unique(CEPAL2004LT$Country)
unique(CEPAL2004LT$Year)
unique(CEPAL2004D$Year)
unique(CEPAL2004D$Age)
unique(CEPAL2004D$Age2)
library(data.table)
library(reshape2)
library(latticeExtra)
setwd('C:/Users/jmaburto/Documents/GitHub/CoD-burden-on-LA')
source('R/1_Get_All_Data.R')
cause.name.vec <- c('Total', 'Infectious','Neoplasms', 'Circulatory','Abnormal', 'Mental',
'Nervous','Endocrine','Digestive',
'Genitourinary','Perinatal','Respiratory','External','Homicide','Rest')
Deaths.data$Cause.name <- Deaths.data$Cause
Deaths.data$Cause.name <- factor(Deaths.data$Cause.name, levels = 1:15, labels = cause.name.vec)
Deaths.data            <- Deaths.data[Deaths.data$Cause > 1,]
Deaths.data            <- Deaths.data[Deaths.data$Age2 < 96]
unique(Deaths.data$Age2)
unique(Deaths.data$Cause.name)
### First create same age groups as in the lifetable information, all sources used (UN, CEPAL and Lambda)
### CEPAL 2004 is 80+
### CEPAL 2010 is 100+
### UN is 85+
### Lambda is 85+
##because there might some years that CoD data closes at 85+ and oders 95+,
##I am closing everything at 85+, after 85+ everything will be accumulated in cause of death 15
##for CEPAL2004, everything will close at 80+
DD <- Deaths.data
unique(DD$Age)
DD[DD$Age2>=80]$Age2 <- 80
DD[DD$Age=="80 - 84" | DD$Age=="85 - 89"|DD$Age=='80-84'|DD$Age=="90 - 94" | DD$Age=="95+"]$Age <- "80+"
CEPAL2004 <- DD[,list(Female=sum(Female)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]
sum(CEPAL2004$Female) - sum(DD$Female)
CEPAL2004$Male <- DD[,list(Male=sum(Male)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]$Male
sum(CEPAL2004$Male) - sum(DD$Male)
unique(CEPAL2004$Age)
## Now for the rest, lets close CoD data at 85
DD <- Deaths.data
unique(DD$Age)
DD[DD$Age2>=85]$Age2 <- 85
DD[DD$Age=="85 - 89"|DD$Age=='80-84'|DD$Age=="90 - 94" | DD$Age=="95+"]$Age <- "85+"
Rest <- DD[,list(Female=sum(Female)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]
sum(Rest$Female) - sum(DD$Female)
Rest$Male <- DD[,list(Male=sum(Male)),by = list(X,Year,Cause,Age,Country,Age2,Cause.name)]$Male
sum(Rest$Male) - sum(DD$Male)
unique(Rest$Age)
unique(CEPAL2004$Age)
CEPAL2004$Source <- 'CEPAL2004'
Rest$Source      <- 'Rest'
save(CEPAL2004,Rest,file = 'Outcomes/Harmonized_CoDData.RData')
gdata::keep(Rest,CEPAL2004,cause.name.vec,Country.code.vec,Country.name.vec,sure = T)
load('Outcomes/Data_Lifetables.RData')
unique(Deaths.data$Age)
unique(Deaths.data$Year)
unique(Data.LT$Year)
unique(CEPAL2004$Age)
unique(CEPAL2004$Year)
unique(Data.LT$Year)
names(Country.code.vec) <- Country.name.vec
CEPAL2004D <-   CEPAL2004[CEPAL2004$X == 2170|CEPAL2004$X == 2140|CEPAL2004$X == 2190|
CEPAL2004$X == 2250|CEPAL2004$X == 2310|CEPAL2004$X == 2340|
CEPAL2004$X == 2020|CEPAL2004$X == 2120|CEPAL2004$X == 2130|
CEPAL2004$X == 2180|CEPAL2004$X == 2360|CEPAL2004$X == 2370|
CEPAL2004$X == 2460|CEPAL2004$X == 2470|CEPAL2004$X == 2070|
CEPAL2004$X == 2150,]
CEPAL2004LT <-            Data.LT[(Data.LT$Code == 2170|Data.LT$Code == 2140|Data.LT$Code == 2190|
Data.LT$Code == 2250|Data.LT$Code == 2310|Data.LT$Code == 2340|
Data.LT$Code == 2020|Data.LT$Code == 2120|Data.LT$Code == 2130|
Data.LT$Code == 2180|Data.LT$Code == 2360|Data.LT$Code == 2370|
Data.LT$Code == 2460|Data.LT$Code == 2470|Data.LT$Code == 2070|
Data.LT$Code == 2150) & Data.LT$Source == 'CEPAL2004',]
unique(CEPAL2004D$Country)
unique(CEPAL2004LT$Country)
unique(CEPAL2004LT$Year)
unique(CEPAL2004D$Year)
Periods      <- seq(1990,2010,5)
Period.labels <- unique(CEPAL2004LT$Period)
CEPAL2004D$Period5       <- (cut(CEPAL2004D$Year+1, breaks=c(Periods,Inf),labels=Period.labels))
CEPAL2004D2 <- CEPAL2004D[,list(Female=sum(Female)), by = list(X,Cause,Age,Country,Age2,Cause.name,Source,Period5)]
CEPAL2004D2$Male <- CEPAL2004D[,list(Male=sum(Male)), by = list(X,Cause,Age,Country,Age2,Cause.name,Source,Period5)]$Male
unique(CEPAL2004D2$Period5)
unique(CEPAL2004D$Age2)
table(CEPAL2004D2$X,CEPAL2004D2$Age)
table(CEPAL2004LT$Period,CEPAL2004LT$Country)
23520/2880
View(Rest)
table(CEPAL2004LT$Period,CEPAL2004LT$Country)
table(CEPAL2004D2$Period5,CEPAL2004D2$Age)
224/36
table(CEPAL2004D2$X,CEPAL2004D2$Age)
table(CEPAL2004D2$Cause,CEPAL2004D2$Age)
unique(CEPAL2004D2$Age2)
unique(CEPAL2004D2$Cause)
table(CEPAL2004D2$Cause,CEPAL2004D2$Age)
Sex       <- unique(CEPAL2004LT$Sex)
Sex
CEPAL2004LT$Sex <- as.numeric(CEPAL2004LT$Sex)
Sex       <- unique(CEPAL2004LT$Sex)
Sex
k <- Sex[1]
j <-2120
Decomp.results <- NULL
Lifetables     <- NULL
Countries <- unique(CEPAL2004E2$X)
Countries <- unique(CEPAL2004D2$X)
Countries
Decomp.results <- NULL
Lifetables     <- NULL
j
k
if (k == 1) sex.col <- 10
if (k == 2) sex.col <- 9
new.data <- CEPAL2004LT[CEPAL2004LT$Code==j & CEPAL2004LT$Sex==k,]
new.CoD  <- CEPAL2004D2[CEPAL2004D2$X==j,]
View(new.data)
View(new.CoD)
P1      <- unique(new.data$Period)
P1
CEPAL2004D2$Period5 <- as.character(CEPAL2004D2$Period5)
if (k == 1) sex.col <- 10
if (k == 2) sex.col <- 9
# subset data with info requireMethods
new.data <- CEPAL2004LT[CEPAL2004LT$Code==j & CEPAL2004LT$Sex==k,]
new.CoD  <- CEPAL2004D2[CEPAL2004D2$X==j,]
P1      <- unique(new.data$Period)
P2      <- unique(new.CoD$Period5)
P1
P2
Periods <- P1
P1      <- unique(new.data$Period)
P2      <- unique(new.CoD$Period5)
Periods <- P1
if ((length(P2) - length(P1))!= 0) print('Problem')
Periods
Periods[-length(P2)]
print(l)
l <- Periods[1]
l
print(l)
p1.data    <- new.data[new.data$Period == l,]
Periods[l+1]
l <- 1
print(l)
p1.data    <- new.data[new.data$Period == Periods[l],]
p2.data    <- new.data[new.data$Period == Periods[l+1],]
CoD.1    <- new.CoD[new.CoD$Period5 == Periods[l],]
CoD.2    <- new.CoD[new.CoD$Period5 == Periods[l+1],]
R1 <- acast(CoD.1, Age3 ~ Cause, value.var = colnames(CoD.1)[sex.col],fill = 0,drop = F)
R1 <- acast(CoD.1, Age2 ~ Cause, value.var = colnames(CoD.1)[sex.col],fill = 0,drop = F)
R1
R2 <- acast(CoD.2, Age2 ~ Cause, value.var = colnames(CoD.2)[sex.col],fill = 0,drop = F)
R2
R1.1 <- R1/rowSums(R1)
R2.1 <- R2/rowSums(R2)
rowSums(R1.1)
rowSums(R2.1)
sum(rowSums(R1.1))
sum(rowSums(R2.1))
if (sum(rowSums(R1.1)) != 21) print('Dimension R1')
if (sum(rowSums(R2.1)) != 21) print('Dimension R2')
mx1 <- p1.data$mx
mx1
mx2 <- p2.data$mx
mx2
Decomp.age <- AgeDecomp(mx1=mx1,mx2=mx2,Age=p1.data$Age,Sex=k)
source('R/Functions_LT.R')
Decomp.age <- AgeDecomp(mx1=mx1,mx2=mx2,Age=p1.data$Age,Sex=k)
print(sum(Decomp.age)-(p2.data$ex[1]-p1.data$ex[1]))
mx1
mx2
Decomp.age <- AgeDecomp(mx1=mx1,mx2=mx2,Age=p1.data$Age,Sex=k)
Decomp.age
sum(Decomp.age)
p2.data$ex[1]
p1.data$ex[1]
(p2.data$ex[1]-p1.data$ex[1])
